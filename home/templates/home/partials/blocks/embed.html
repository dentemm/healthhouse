{% load home_tags wagtailembeds_tags %}

{% with value.url|split:"=" as yt_id %}
<div class="row justify-content-center">
  <div class="col-md-12 col-lg-10">
    <div style="padding-top: 60%">
      <iframe id="prefix-{{ yt_id }}" width="100%" height="100%" src="{{Â value.url }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" style="position:absolute;top:0;">
      </iframe>
    </div>
  </div>
</div>

<script defer>
  window.onload = function () {

    const getId = (url) => {
        const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
        const match = url.match(regExp);

        return (match && match[2].length === 11) ? match[2] : null;
    };
        
    const videoId = getId('{{ value.url }}');

    if (videoId) {
      console.log(`videoId: ${videoId}`)
      $('#prefix-{{ yt_id }}').attr('src', `//www.youtube.com/embed/${videoId}`);
    }
  }
</script>
{% endwith %}